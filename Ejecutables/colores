#!/bin/bash

# Códigos de color ANSI de 8 bits
NEGRO='\033[0;30m'
ROJO='\033[0;31m'
VERDE='\033[0;32m'
AMARILLO='\033[0;33m'
AZUL='\033[0;34m'
MORADO='\033[0;35m'
CIAN='\033[0;36m'
BLANCO='\033[0;37m'

# Códigos de color ANSI de 24 bits
ROJO_BRILLANTE='\033[38;2;255;69;0m'
VERDE_BRILLANTE='\033[38;2;76;175;80m'
AZUL_BRILLANTE='\033[38;2;0;188;212m'
MORADO_BRILLANTE='\033[38;2;186;85;211m'

# Códigos de formato
NEGRITA='\033[1m'
SUBRAYADO='\033[4m'
RESET='\033[0m'

# Función para imprimir mensajes con color y formato
msg() {
    local color="${1}"
    local formato="${2}"
    local texto="${3}"
    printf "${color}${formato}${texto}${RESET}\n"
}

# Función para imprimir mensajes centrados
print_center() {
    local texto="${1}"
    local ancho="${2:-54}"
    local longitud="${#texto}"
    local padding=$(((ancho - longitud) / 2))
    printf "%${padding}s%s\n" " " "${texto}"
}

# Función para mostrar una barra de progreso básica
barra_intallb() {
    local comando="${1}"
    local pid
    ${comando} >/dev/null 2>&1 &
    pid=$!
    while [[ -d /proc/${pid} ]]; do
        msg "${AMARILLO}" "${NEGRITA}" "  [" && printf "${ROJO_BRILLANTE}%*s" 40 "" && msg "${AMARILLO}" "${NEGRITA}" "]"
        sleep 0.1s
        tput cuu1 && tput dl1
    done
    msg "${VERDE_BRILLANTE}" "${NEGRITA}" "  [${ROJO_BRILLANTE}>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>${VERDE_BRILLANTE}] - ${AMARILLO}${NEGRITA}OK${RESET}"
    sleep 1s
}

# Función para mostrar una barra de progreso de instalación de paquetes
barra_intall() {
    local comando="${1}"
    local paquete="${2}"
    local pid
    ${comando} >/dev/null 2>&1 &
    pid=$!
    while [[ -d /proc/${pid} ]]; do
        msg "${AMARILLO}" "${NEGRITA}" "  [" && printf "${ROJO_BRILLANTE}%*s" 20 "" && msg "${AMARILLO}" "${NEGRITA}" "]"
        sleep 0.08s
        tput cuu1 && tput dl1
    done
    if [[ $(dpkg --get-selections | grep -w "${paquete}" | head -1) ]]; then
        msg "${VERDE_BRILLANTE}" "${NEGRITA}" "       ${AMARILLO}${NEGRITA}INSTALADO${RESET}"
    else
        msg "${ROJO_BRILLANTE}" "${NEGRITA}" "  ${AMARILLO}${NEGRITA}FALLO DE INSTALACIÓN${RESET}"
    fi
    sleep 0.5s
}

# Ejemplos de uso
print_center "${MORADO_BRILLANTE}${NEGRITA}${SUBRAYADO}Título Elegante${RESET}"
msg "${AZUL_BRILLANTE}" "${NEGRITA}" "Este es un mensaje en azul brillante y negrita."
barra_intallb "sleep 5"
barra_intall "apt-get install -y git" "git"
